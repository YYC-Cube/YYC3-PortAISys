# YYCÂ³ æ–‡æ¡£åŒæ­¥å·¥å…·ç³»ç»Ÿéƒ¨ç½²æ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯

**æ–‡æ¡£åç§°**: æ–‡æ¡£åŒæ­¥å·¥å…·ç³»ç»Ÿéƒ¨ç½²æ–‡æ¡£  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¥æœŸ**: 2026-01-20  
**æ–‡æ¡£çŠ¶æ€**: âœ… å·²å®Œæˆ  
**ç»´æŠ¤å›¢é˜Ÿ**: YYCÂ³ è¿ç»´å›¢é˜Ÿ  

---

## ä¸€ã€éƒ¨ç½²æ¦‚è¿°

### 1.1 éƒ¨ç½²ç›®æ ‡

**æ ¸å¿ƒç›®æ ‡**:
åœ¨ç›®æ ‡ç¯å¢ƒä¸­éƒ¨ç½²YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œæ»¡è¶³ç”Ÿäº§ç¯å¢ƒè¦æ±‚ã€‚

**å…·ä½“ç›®æ ‡**:
1. å®Œæˆç³»ç»Ÿå®‰è£…å’Œé…ç½®
2. éƒ¨ç½²ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ
3. éªŒè¯ç³»ç»ŸåŠŸèƒ½å’Œæ€§èƒ½
4. å»ºç«‹è¿ç»´ç®¡ç†æµç¨‹

### 1.2 éƒ¨ç½²èŒƒå›´

**éƒ¨ç½²ç»„ä»¶**:
- æ–‡æ¡£åŒæ­¥æ ¸å¿ƒæœåŠ¡
- ç›‘æ§æœåŠ¡
- å‘Šè­¦ç³»ç»Ÿ
- æ—¥å¿—ç³»ç»Ÿ
- é…ç½®ç®¡ç†

**éƒ¨ç½²ç¯å¢ƒ**:
- å¼€å‘ç¯å¢ƒ
- æµ‹è¯•ç¯å¢ƒ
- é¢„ç”Ÿäº§ç¯å¢ƒ
- ç”Ÿäº§ç¯å¢ƒ

---

## äºŒã€ç¯å¢ƒè¦æ±‚

### 2.1 ç¡¬ä»¶è¦æ±‚

**æœ€ä½é…ç½®**:
- CPU: 2æ ¸å¿ƒ
- å†…å­˜: 4GB
- ç£ç›˜: 100GB SSD
- ç½‘ç»œ: 100Mbps

**æ¨èé…ç½®**:
- CPU: 4æ ¸å¿ƒ
- å†…å­˜: 8GB
- ç£ç›˜: 500GB SSD
- ç½‘ç»œ: 1Gbps

**ç”Ÿäº§ç¯å¢ƒé…ç½®**:
- CPU: 8æ ¸å¿ƒ
- å†…å­˜: 16GB
- ç£ç›˜: 1TB SSD
- ç½‘ç»œ: 10Gbps

### 2.2 è½¯ä»¶è¦æ±‚

**æ“ä½œç³»ç»Ÿ**:
- macOS 12.0+
- Ubuntu 20.04+
- CentOS 8+
- Windows 10+ (WSL2)

**è¿è¡Œç¯å¢ƒ**:
- Node.js >= 18.0.0
- npm >= 8.0.0
- Git >= 2.30.0

**ä¾èµ–æœåŠ¡**:
- æ•°æ®åº“: PostgreSQL 13+ (å¯é€‰)
- ç¼“å­˜: Redis 6+ (å¯é€‰)
- æ¶ˆæ¯é˜Ÿåˆ—: RabbitMQ 3.8+ (å¯é€‰)

---

## ä¸‰ã€éƒ¨ç½²æ­¥éª¤

### 3.1 å‡†å¤‡å·¥ä½œ

#### 3.1.1 ç¯å¢ƒæ£€æŸ¥

**æ£€æŸ¥è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ” ç¯å¢ƒæ£€æŸ¥"
echo "=============="

# æ£€æŸ¥æ“ä½œç³»ç»Ÿ
OS=$(uname -s)
echo "æ“ä½œç³»ç»Ÿ: $OS"

# æ£€æŸ¥CPU
CPU_CORES=$(nproc 2>/dev/null || sysctl -n hw.ncpu 2>/dev/null || echo "Unknown")
echo "CPUæ ¸å¿ƒæ•°: $CPU_CORES"

# æ£€æŸ¥å†…å­˜
MEMORY=$(free -h 2>/dev/null | awk '/^Mem:/ {print $2}' || echo "Unknown")
echo "å†…å­˜: $MEMORY"

# æ£€æŸ¥ç£ç›˜ç©ºé—´
DISK=$(df -h / 2>/dev/null | awk 'NR==2 {print $4}' || echo "Unknown")
echo "å¯ç”¨ç£ç›˜ç©ºé—´: $DISK"

# æ£€æŸ¥Node.js
if command -v node &> /dev/null; then
    NODE_VERSION=$(node -v)
    echo "Node.jsç‰ˆæœ¬: $NODE_VERSION"
    
    # æ£€æŸ¥ç‰ˆæœ¬æ˜¯å¦æ»¡è¶³è¦æ±‚
    NODE_MAJOR=$(echo $NODE_VERSION | cut -d'v' -f2 | cut -d'.' -f1)
    if [ "$NODE_MAJOR" -lt 18 ]; then
        echo "âŒ Node.jsç‰ˆæœ¬è¿‡ä½ï¼Œéœ€è¦18.0.0æˆ–æ›´é«˜"
        exit 1
    else
        echo "âœ… Node.jsç‰ˆæœ¬æ»¡è¶³è¦æ±‚"
    fi
else
    echo "âŒ æœªæ‰¾åˆ°Node.js"
    exit 1
fi

# æ£€æŸ¥npm
if command -v npm &> /dev/null; then
    NPM_VERSION=$(npm -v)
    echo "npmç‰ˆæœ¬: $NPM_VERSION"
else
    echo "âŒ æœªæ‰¾åˆ°npm"
    exit 1
fi

echo "âœ… ç¯å¢ƒæ£€æŸ¥å®Œæˆ"
```

#### 3.1.2 ä¾èµ–å®‰è£…

**å®‰è£…è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ“¦ ä¾èµ–å®‰è£…"
echo "============"

# æ›´æ–°åŒ…ç®¡ç†å™¨
if command -v apt-get &> /dev/null; then
    echo "æ›´æ–°aptåŒ…ç®¡ç†å™¨..."
    sudo apt-get update
elif command -v yum &> /dev/null; then
    echo "æ›´æ–°yumåŒ…ç®¡ç†å™¨..."
    sudo yum update -y
elif command -v brew &> /dev/null; then
    echo "æ›´æ–°Homebrew..."
    brew update
fi

# å®‰è£…Node.jsï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
if ! command -v node &> /dev/null; then
    echo "å®‰è£…Node.js..."
    if command -v apt-get &> /dev/null; then
        sudo apt-get install -y curl
        curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
        sudo apt-get install -y nodejs
    elif command -v yum &> /dev/null; then
        sudo yum install -y curl
        curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
        sudo yum install -y nodejs npm
    elif command -v brew &> /dev/null; then
        brew install node
    fi
fi

# å®‰è£…Gitï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
if ! command -v git &> /dev/null; then
    echo "å®‰è£…Git..."
    if command -v apt-get &> /dev/null; then
        sudo apt-get install -y git
    elif command -v yum &> /dev/null; then
        sudo yum install -y git
    elif command -v brew &> /dev/null; then
        brew install git
    fi
fi

echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
```

### 3.2 ç³»ç»Ÿéƒ¨ç½²

#### 3.2.1 è·å–æºç 

**éƒ¨ç½²è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ“¥ è·å–æºç "
echo "============"

# è®¾ç½®éƒ¨ç½²ç›®å½•
DEPLOY_DIR="/opt/yyc3-doc-sync"
SERVICE_USER="yyc3"

# åˆ›å»ºæœåŠ¡ç”¨æˆ·
if ! id "$SERVICE_USER" &>/dev/null; then
    echo "åˆ›å»ºæœåŠ¡ç”¨æˆ·: $SERVICE_USER"
    sudo useradd -r -s /bin/false $SERVICE_USER
fi

# åˆ›å»ºéƒ¨ç½²ç›®å½•
sudo mkdir -p $DEPLOY_DIR
sudo chown $SERVICE_USER:$SERVICE_USER $DEPLOY_DIR

# è·å–æºç 
if [ -d ".git" ]; then
    echo "ä»Gitä»“åº“æ‹‰å–æœ€æ–°ä»£ç ..."
    sudo -u $SERVICE_USER git clone https://github.com/yyc3/doc-code-sync.git $DEPLOY_DIR
else
    echo "å¤åˆ¶æœ¬åœ°ä»£ç ..."
    sudo cp -r . $DEPLOY_DIR
    sudo chown -R $SERVICE_USER:$SERVICE_USER $DEPLOY_DIR
fi

cd $DEPLOY_DIR
echo "âœ… æºç è·å–å®Œæˆ"
```

#### 3.2.2 å®‰è£…ä¾èµ–

**éƒ¨ç½²è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ“¦ å®‰è£…ä¾èµ–"
echo "============"

cd $DEPLOY_DIR

# å®‰è£…Node.jsä¾èµ–
sudo -u $SERVICE_USER npm install --production

# åˆ›å»ºå¿…è¦ç›®å½•
sudo -u $SERVICE_USER mkdir -p logs
sudo -u $SERVICE_USER mkdir -p data
sudo -u $SERVICE_USER mkdir -p config

echo "âœ… ä¾èµ–å®‰è£…å®Œæˆ"
```

#### 3.2.3 æ„å»ºé¡¹ç›®

**éƒ¨ç½²è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ”¨ æ„å»ºé¡¹ç›®"
echo "============"

cd $DEPLOY_DIR

# æ„å»ºé¡¹ç›®
sudo -u $SERVICE_USER npm run build

# éªŒè¯æ„å»ºç»“æœ
if [ ! -d "dist" ]; then
    echo "âŒ é¡¹ç›®æ„å»ºå¤±è´¥"
    exit 1
fi

echo "âœ… é¡¹ç›®æ„å»ºå®Œæˆ"
```

### 3.3 é…ç½®ç®¡ç†

#### 3.3.1 ç¯å¢ƒé…ç½®

**é…ç½®è„šæœ¬**:
```bash
#!/bin/bash

echo "âš™ï¸ ç¯å¢ƒé…ç½®"
echo "=============="

cd $DEPLOY_DIR

# åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶
sudo -u $SERVICE_USER tee config/.env > /dev/null << 'EOF'
# YYCÂ³ æ–‡æ¡£åŒæ­¥å·¥å…·ç¯å¢ƒé…ç½®

# æœåŠ¡é…ç½®
NODE_ENV=production
PORT=3100
HOST=0.0.0.0

# æ•°æ®åº“é…ç½®ï¼ˆå¯é€‰ï¼‰
# DATABASE_URL=postgresql://user:password@localhost:5432/yyc3_sync

# ç¼“å­˜é…ç½®ï¼ˆå¯é€‰ï¼‰
# REDIS_URL=redis://localhost:6379

# æ—¥å¿—é…ç½®
LOG_LEVEL=info
LOG_DIR=logs

# ç›‘æ§é…ç½®
MONITORING_ENABLED=true
METRICS_PORT=3101
ALERT_WEBHOOK_URL=https://hooks.slack.com/services/xxx

# å®‰å…¨é…ç½®
JWT_SECRET=$(openssl rand -base64 32)
API_KEY=$(openssl rand -base64 32)

# åŒæ­¥é…ç½®
DEFAULT_SYNC_INTERVAL=300
DEFAULT_CONFLICT_RESOLUTION=manual
MAX_CONCURRENT_SYNCS=50
EOF

echo "âœ… ç¯å¢ƒé…ç½®å®Œæˆ"
```

#### 3.3.2 æœåŠ¡é…ç½®

**é…ç½®è„šæœ¬**:
```bash
#!/bin/bash

echo "âš™ï¸ æœåŠ¡é…ç½®"
echo "=============="

cd $DEPLOY_DIR

# åˆ›å»ºsystemdæœåŠ¡æ–‡ä»¶
sudo tee /etc/systemd/system/yyc3-doc-sync.service > /dev/null << 'EOF'
[Unit]
Description=YYCÂ³ æ–‡æ¡£åŒæ­¥å·¥å…·
After=network.target

[Service]
Type=simple
User=yyc3
WorkingDirectory=/opt/yyc3-doc-sync
ExecStart=/usr/bin/node /opt/yyc3-doc-sync/dist/index.js watch
Restart=always
RestartSec=10
Environment=NODE_ENV=production

[Install]
WantedBy=multi-user.target
EOF

# é‡æ–°åŠ è½½systemdé…ç½®
sudo systemctl daemon-reload

# å¯ç”¨æœåŠ¡
sudo systemctl enable yyc3-doc-sync.service

echo "âœ… æœåŠ¡é…ç½®å®Œæˆ"
```

### 3.4 æœåŠ¡å¯åŠ¨

#### 3.4.1 å¯åŠ¨æœåŠ¡

**å¯åŠ¨è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸš€ å¯åŠ¨æœåŠ¡"
echo "============"

# å¯åŠ¨ä¸»æœåŠ¡
sudo systemctl start yyc3-doc-sync.service

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
if sudo systemctl is-active --quiet yyc3-doc-sync.service; then
    echo "âœ… ä¸»æœåŠ¡å¯åŠ¨æˆåŠŸ"
else
    echo "âŒ ä¸»æœåŠ¡å¯åŠ¨å¤±è´¥"
    sudo systemctl status yyc3-doc-sync.service
    exit 1
fi

# å¯åŠ¨ç›‘æ§ä»ªè¡¨æ¿ï¼ˆå¯é€‰ï¼‰
if [ "$1" = "--with-dashboard" ]; then
    sudo -u yyc3 nohup node dist/index.js dashboard > logs/dashboard.log 2>&1 &
    DASHBOARD_PID=$!
    sudo -u yyc3 echo $DASHBOARD_PID > .dashboard.pid
    echo "âœ… ç›‘æ§ä»ªè¡¨æ¿å¯åŠ¨æˆåŠŸ (PID: $DASHBOARD_PID)"
fi

echo "âœ… æœåŠ¡å¯åŠ¨å®Œæˆ"
```

#### 3.4.2 éªŒè¯æœåŠ¡

**éªŒè¯è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ” éªŒè¯æœåŠ¡"
echo "============"

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "æ£€æŸ¥ä¸»æœåŠ¡çŠ¶æ€..."
if sudo systemctl is-active --quiet yyc3-doc-sync.service; then
    echo "âœ… ä¸»æœåŠ¡è¿è¡Œæ­£å¸¸"
else
    echo "âŒ ä¸»æœåŠ¡æœªè¿è¡Œ"
    exit 1
fi

# æ£€æŸ¥ç«¯å£ç›‘å¬
echo "æ£€æŸ¥ç«¯å£ç›‘å¬..."
if netstat -tuln | grep -q ":3100 "; then
    echo "âœ… ç«¯å£3100ç›‘å¬æ­£å¸¸"
else
    echo "âŒ ç«¯å£3100æœªç›‘å¬"
    exit 1
fi

# æ£€æŸ¥æ—¥å¿—è¾“å‡º
echo "æ£€æŸ¥æ—¥å¿—è¾“å‡º..."
if sudo -u yyc3 test -f logs/monitor.log; then
    echo "âœ… æ—¥å¿—è¾“å‡ºæ­£å¸¸"
else
    echo "âŒ æ—¥å¿—è¾“å‡ºå¼‚å¸¸"
    exit 1
fi

# æ£€æŸ¥å¥åº·çŠ¶æ€
echo "æ£€æŸ¥å¥åº·çŠ¶æ€..."
HEALTH_CHECK=$(curl -s http://localhost:3100/health 2>/dev/null || echo "failed")
if [ "$HEALTH_CHECK" != "failed" ]; then
    echo "âœ… å¥åº·æ£€æŸ¥é€šè¿‡"
else
    echo "âŒ å¥åº·æ£€æŸ¥å¤±è´¥"
    exit 1
fi

echo "âœ… æœåŠ¡éªŒè¯å®Œæˆ"
```

---

## å››ã€è¿ç»´ç®¡ç†

### 4.1 æœåŠ¡ç®¡ç†

#### 4.1.1 å¸¸ç”¨å‘½ä»¤

**æœåŠ¡ç®¡ç†**:
```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start yyc3-doc-sync.service

# åœæ­¢æœåŠ¡
sudo systemctl stop yyc3-doc-sync.service

# é‡å¯æœåŠ¡
sudo systemctl restart yyc3-doc-sync.service

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
sudo systemctl status yyc3-doc-sync.service

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
sudo journalctl -u yyc3-doc-sync.service -f
```

#### 4.1.2 æ—¥å¿—ç®¡ç†

**æ—¥å¿—ç®¡ç†**:
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
sudo -u yyc3 tail -f /opt/yyc3-doc-sync/logs/monitor.log

# æŸ¥çœ‹å‘Šè­¦æ—¥å¿—
sudo -u yyc3 tail -f /opt/yyc3-doc-sync/logs/alerts.log

# æŸ¥çœ‹åŒæ­¥æ—¥å¿—
sudo -u yyc3 tail -f /opt/yyc3-doc-sync/logs/sync.log

# æ¸…ç†æ—§æ—¥å¿—ï¼ˆä¿ç•™7å¤©ï¼‰
sudo -u yyc3 find /opt/yyc3-doc-sync/logs -name "*.log" -mtime +7 -delete

# å‹ç¼©æ—¥å¿—æ–‡ä»¶
sudo -u yyc3 find /opt/yyc3-doc-sync/logs -name "*.log" -mtime +1 -exec gzip {} \;
```

### 4.2 ç›‘æ§ç®¡ç†

#### 4.2.1 ç›‘æ§æ£€æŸ¥

**ç›‘æ§è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ“Š ç›‘æ§æ£€æŸ¥"
echo "============"

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
SERVICE_STATUS=$(sudo systemctl is-active yyc3-doc-sync.service)
echo "æœåŠ¡çŠ¶æ€: $SERVICE_STATUS"

# æ£€æŸ¥CPUä½¿ç”¨ç‡
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
echo "CPUä½¿ç”¨ç‡: ${CPU_USAGE}%"

# æ£€æŸ¥å†…å­˜ä½¿ç”¨ç‡
MEMORY_USAGE=$(free | grep Mem | awk '{printf("%.1f", $3/$2 * 100.0)}')
echo "å†…å­˜ä½¿ç”¨ç‡: ${MEMORY_USAGE}%"

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡
DISK_USAGE=$(df / | awk 'NR==2 {print $5}' | cut -d'%' -f1)
echo "ç£ç›˜ä½¿ç”¨ç‡: ${DISK_USAGE}%"

# æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
if [ -f "/opt/yyc3-doc-sync/.monitor.pid" ]; then
    MONITOR_PID=$(cat /opt/yyc3-doc-sync/.monitor.pid)
    if kill -0 $MONITOR_PID 2>/dev/null; then
        echo "ç›‘æ§è¿›ç¨‹: è¿è¡Œä¸­ (PID: $MONITOR_PID)"
    else
        echo "ç›‘æ§è¿›ç¨‹: æœªè¿è¡Œ"
    fi
else
    echo "ç›‘æ§è¿›ç¨‹: æœªå¯åŠ¨"
fi

# æ£€æŸ¥å‘Šè­¦æ•°é‡
ALERT_COUNT=$(sudo -u yyc3 grep -c "ERROR" /opt/yyc3-doc-sync/logs/monitor.log 2>/dev/null || echo "0")
echo "å‘Šè­¦æ•°é‡: $ALERT_COUNT"

echo "âœ… ç›‘æ§æ£€æŸ¥å®Œæˆ"
```

#### 4.2.2 å‘Šè­¦å¤„ç†

**å‘Šè­¦è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸš¨ å‘Šè­¦å¤„ç†"
echo "============"

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
if ! sudo systemctl is-active --quiet yyc3-doc-sync.service; then
    echo "ğŸš¨ æœåŠ¡å‘Šè­¦: ä¸»æœåŠ¡æœªè¿è¡Œ"
    # å‘é€å‘Šè­¦é€šçŸ¥
    curl -X POST -H 'Content-type: application/json' \
        --data '{"text":"ğŸš¨ YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·å‘Šè­¦: ä¸»æœåŠ¡æœªè¿è¡Œ"}' \
        $ALERT_WEBHOOK_URL
fi

# æ£€æŸ¥CPUä½¿ç”¨ç‡
CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
if (( $(echo "$CPU_USAGE > 85" | bc -l) )); then
    echo "ğŸš¨ èµ„æºå‘Šè­¦: CPUä½¿ç”¨ç‡è¿‡é«˜ (${CPU_USAGE}%)"
    # å‘é€å‘Šè­¦é€šçŸ¥
    curl -X POST -H 'Content-type: application/json' \
        --data "{\"text\":\"ğŸš¨ YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·å‘Šè­¦: CPUä½¿ç”¨ç‡è¿‡é«˜ (${CPU_USAGE}%)\"}" \
        $ALERT_WEBHOOK_URL
fi

# æ£€æŸ¥å†…å­˜ä½¿ç”¨ç‡
MEMORY_USAGE=$(free | grep Mem | awk '{printf("%.1f", $3/$2 * 100.0)}')
if (( $(echo "$MEMORY_USAGE > 90" | bc -l) )); then
    echo "ğŸš¨ èµ„æºå‘Šè­¦: å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ (${MEMORY_USAGE}%)"
    # å‘é€å‘Šè­¦é€šçŸ¥
    curl -X POST -H 'Content-type: application/json' \
        --data "{\"text\":\"ğŸš¨ YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·å‘Šè­¦: å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ (${MEMORY_USAGE}%)\"}" \
        $ALERT_WEBHOOK_URL
fi

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨ç‡
DISK_USAGE=$(df / | awk 'NR==2 {print $5}' | cut -d'%' -f1)
if [ "$DISK_USAGE" -gt 90 ]; then
    echo "ğŸš¨ èµ„æºå‘Šè­¦: ç£ç›˜ä½¿ç”¨ç‡è¿‡é«˜ (${DISK_USAGE}%)"
    # å‘é€å‘Šè­¦é€šçŸ¥
    curl -X POST -H 'Content-type: application/json' \
        --data "{\"text\":\"ğŸš¨ YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·å‘Šè­¦: ç£ç›˜ä½¿ç”¨ç‡è¿‡é«˜ (${DISK_USAGE}%)\"}" \
        $ALERT_WEBHOOK_URL
fi

echo "âœ… å‘Šè­¦æ£€æŸ¥å®Œæˆ"
```

### 4.3 å¤‡ä»½ç®¡ç†

#### 4.3.1 æ•°æ®å¤‡ä»½

**å¤‡ä»½è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ’¾ æ•°æ®å¤‡ä»½"
echo "============"

# è®¾ç½®å¤‡ä»½ç›®å½•
BACKUP_DIR="/backup/yyc3-doc-sync"
BACKUP_DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½ç›®å½•
sudo mkdir -p $BACKUP_DIR

# å¤‡ä»½é…ç½®æ–‡ä»¶
sudo tar -czf $BACKUP_DIR/config_$BACKUP_DATE.tar.gz -C /opt/yyc3-doc-sync config/

# å¤‡ä»½æ•°æ®æ–‡ä»¶
sudo tar -czf $BACKUP_DIR/data_$BACKUP_DATE.tar.gz -C /opt/yyc3-doc-sync data/

# å¤‡ä»½æ—¥å¿—æ–‡ä»¶
sudo tar -czf $BACKUP_DIR/logs_$BACKUP_DATE.tar.gz -C /opt/yyc3-doc-sync logs/

# æ¸…ç†æ—§å¤‡ä»½ï¼ˆä¿ç•™7å¤©ï¼‰
sudo find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete

echo "âœ… æ•°æ®å¤‡ä»½å®Œæˆ"
echo "å¤‡ä»½ä½ç½®: $BACKUP_DIR"
```

#### 4.3.2 æ•°æ®æ¢å¤

**æ¢å¤è„šæœ¬**:
```bash
#!/bin/bash

echo "ğŸ”„ æ•°æ®æ¢å¤"
echo "============"

# æ£€æŸ¥å¤‡ä»½æ–‡ä»¶
if [ -z "$1" ]; then
    echo "ç”¨æ³•: $0 <å¤‡ä»½æ—¥æœŸ>"
    echo "å¯ç”¨å¤‡ä»½:"
    ls -la /backup/yyc3-doc-sync/
    exit 1
fi

BACKUP_DATE=$1
BACKUP_DIR="/backup/yyc3-doc-sync"

# åœæ­¢æœåŠ¡
sudo systemctl stop yyc3-doc-sync.service

# æ¢å¤é…ç½®æ–‡ä»¶
if [ -f "$BACKUP_DIR/config_$BACKUP_DATE.tar.gz" ]; then
    echo "æ¢å¤é…ç½®æ–‡ä»¶..."
    sudo rm -rf /opt/yyc3-doc-sync/config
    sudo tar -xzf $BACKUP_DIR/config_$BACKUP_DATE.tar.gz -C /opt/yyc3-doc-sync/
fi

# æ¢å¤æ•°æ®æ–‡ä»¶
if [ -f "$BACKUP_DIR/data_$BACKUP_DATE.tar.gz" ]; then
    echo "æ¢å¤æ•°æ®æ–‡ä»¶..."
    sudo rm -rf /opt/yyc3-doc-sync/data
    sudo tar -xzf $BACKUP_DIR/data_$BACKUP_DATE.tar.gz -C /opt/yyc3-doc-sync/
fi

# æ¢å¤æ—¥å¿—æ–‡ä»¶
if [ -f "$BACKUP_DIR/logs_$BACKUP_DATE.tar.gz" ]; then
    echo "æ¢å¤æ—¥å¿—æ–‡ä»¶..."
    sudo rm -rf /opt/yyc3-doc-sync/logs
    sudo tar -xzf $BACKUP_DIR/logs_$BACKUP_DATE.tar.gz -C /opt/yyc3-doc-sync/
fi

# ä¿®å¤æƒé™
sudo chown -R yyc3:yyc3 /opt/yyc3-doc-sync/

# å¯åŠ¨æœåŠ¡
sudo systemctl start yyc3-doc-sync.service

echo "âœ… æ•°æ®æ¢å¤å®Œæˆ"
```

---

## äº”ã€æ•…éšœæ’é™¤

### 5.1 å¸¸è§é—®é¢˜

#### 5.1.1 æœåŠ¡å¯åŠ¨å¤±è´¥

**é—®é¢˜**: æœåŠ¡å¯åŠ¨å¤±è´¥

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
   ```bash
   sudo systemctl status yyc3-doc-sync.service
   ```

2. æŸ¥çœ‹æœåŠ¡æ—¥å¿—
   ```bash
   sudo journalctl -u yyc3-doc-sync.service -n 50
   ```

3. æ£€æŸ¥ç«¯å£å ç”¨
   ```bash
   sudo netstat -tuln | grep 3100
   ```

4. æ£€æŸ¥æ–‡ä»¶æƒé™
   ```bash
   ls -la /opt/yyc3-doc-sync/
   ```

**è§£å†³æ–¹æ¡ˆ**:
- ä¿®å¤é…ç½®é”™è¯¯
- é‡Šæ”¾å ç”¨ç«¯å£
- è°ƒæ•´æ–‡ä»¶æƒé™
- é‡å¯æœåŠ¡

#### 5.1.2 æ€§èƒ½é—®é¢˜

**é—®é¢˜**: ç³»ç»Ÿæ€§èƒ½ä¸‹é™

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ç³»ç»Ÿèµ„æº
   ```bash
   top
   free -h
   df -h
   ```

2. æ£€æŸ¥è¿›ç¨‹çŠ¶æ€
   ```bash
   ps aux | grep node
   ```

3. æ£€æŸ¥ç½‘ç»œè¿æ¥
   ```bash
   netstat -an | grep ESTABLISHED | wc -l
   ```

**è§£å†³æ–¹æ¡ˆ**:
- ä¼˜åŒ–é…ç½®å‚æ•°
- å¢åŠ ç³»ç»Ÿèµ„æº
- æ¸…ç†æ—¥å¿—æ–‡ä»¶
- é‡å¯æœåŠ¡

#### 5.1.3 åŒæ­¥å¤±è´¥

**é—®é¢˜**: æ–‡æ¡£åŒæ­¥å¤±è´¥

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥æ˜ å°„é…ç½®
   ```bash
   cat /opt/yyc3-doc-sync/.doc-code-mapping.json
   ```

2. æ£€æŸ¥æ–‡ä»¶æƒé™
   ```bash
   ls -la /path/to/docs
   ls -la /path/to/code
   ```

3. æŸ¥çœ‹åŒæ­¥æ—¥å¿—
   ```bash
   sudo -u yyc3 tail -f /opt/yyc3-doc-sync/logs/sync.log
   ```

**è§£å†³æ–¹æ¡ˆ**:
- ä¿®å¤æ˜ å°„è§„åˆ™
- è°ƒæ•´æ–‡ä»¶æƒé™
- æ£€æŸ¥ç£ç›˜ç©ºé—´
- é‡å¯åŒæ­¥æœåŠ¡

### 5.2 åº”æ€¥å¤„ç†

#### 5.2.1 æœåŠ¡å´©æºƒ

**å¤„ç†æµç¨‹**:
1. ç«‹å³é‡å¯æœåŠ¡
   ```bash
   sudo systemctl restart yyc3-doc-sync.service
   ```

2. æ£€æŸ¥å´©æºƒåŸå› 
   ```bash
   sudo journalctl -u yyc3-doc-sync.service -n 100
   ```

3. ä¿å­˜ç°åœºæ•°æ®
   ```bash
   sudo tar -czf /tmp/crash_$(date +%Y%m%d_%H%M%S).tar.gz -C /opt/yyc3-doc-sync logs/
   ```

4. é€šçŸ¥ç›¸å…³äººå‘˜
   ```bash
   curl -X POST -H 'Content-type: application/json' \
       --data '{"text":"ğŸš¨ YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·æœåŠ¡å´©æºƒï¼Œæ­£åœ¨å¤„ç†"}' \
       $ALERT_WEBHOOK_URL
   ```

#### 5.2.2 æ•°æ®ä¸¢å¤±

**å¤„ç†æµç¨‹**:
1. ç«‹å³åœæ­¢æœåŠ¡
   ```bash
   sudo systemctl stop yyc3-doc-sync.service
   ```

2. æ£€æŸ¥æ•°æ®çŠ¶æ€
   ```bash
   find /opt/yyc3-doc-sync/data -type f -mtime -1
   ```

3. æ¢å¤å¤‡ä»½æ•°æ®
   ```bash
   /opt/yyc3-doc-sync/scripts/restore.sh <æœ€æ–°å¤‡ä»½æ—¥æœŸ>
   ```

4. éªŒè¯æ•°æ®å®Œæ•´æ€§
   ```bash
   /opt/yyc3-doc-sync/scripts/verify-data.sh
   ```

---

## å…­ã€å‡çº§ç®¡ç†

### 6.1 å‡çº§æµç¨‹

#### 6.1.1 å‡†å¤‡å·¥ä½œ

**å‡çº§å‰æ£€æŸ¥**:
1. å¤‡ä»½å½“å‰æ•°æ®
   ```bash
   /opt/yyc3-doc-sync/scripts/backup.sh
   ```

2. æ£€æŸ¥å‡çº§ç‰ˆæœ¬
   ```bash
   curl -s https://api.github.com/repos/yyc3/doc-code-sync/releases/latest | grep tag_name
   ```

3. å‡†å¤‡å‡çº§åŒ…
   ```bash
   wget https://github.com/yyc3/doc-code-sync/archive/v1.1.0.tar.gz
   ```

#### 6.1.2 æ‰§è¡Œå‡çº§

**å‡çº§æ­¥éª¤**:
1. åœæ­¢æœåŠ¡
   ```bash
   sudo systemctl stop yyc3-doc-sync.service
   ```

2. å¤‡ä»½å½“å‰ç‰ˆæœ¬
   ```bash
   sudo cp -r /opt/yyc3-doc-sync /opt/yyc3-doc-sync.backup
   ```

3. éƒ¨ç½²æ–°ç‰ˆæœ¬
   ```bash
   sudo rm -rf /opt/yyc3-doc-sync
   sudo tar -xzf v1.1.0.tar.gz -C /opt/
   sudo mv /opt/doc-code-sync-1.1.0 /opt/yyc3-doc-sync
   ```

4. å®‰è£…ä¾èµ–
   ```bash
   cd /opt/yyc3-doc-sync
   sudo -u yyc3 npm install --production
   sudo -u yyc3 npm run build
   ```

5. æ¢å¤é…ç½®
   ```bash
   sudo cp -r /opt/yyc3-doc-sync.backup/config /opt/yyc3-doc-sync/
   sudo cp -r /opt/yyc3-doc-sync.backup/data /opt/yyc3-doc-sync/
   ```

6. å¯åŠ¨æœåŠ¡
   ```bash
   sudo systemctl start yyc3-doc-sync.service
   ```

#### 6.1.3 å‡çº§éªŒè¯

**éªŒè¯æ­¥éª¤**:
1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
   ```bash
   sudo systemctl status yyc3-doc-sync.service
   ```

2. éªŒè¯åŠŸèƒ½æ­£å¸¸
   ```bash
   curl -s http://localhost:3100/health
   ```

3. æ£€æŸ¥ç‰ˆæœ¬ä¿¡æ¯
   ```bash
   curl -s http://localhost:3100/version
   ```

4. è¿è¡Œæµ‹è¯•ç”¨ä¾‹
   ```bash
   /opt/yyc3-doc-sync/scripts/test.sh
   ```

---

## ä¸ƒã€æ€»ç»“

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†YYCÂ³æ–‡æ¡£åŒæ­¥å·¥å…·çš„ç³»ç»Ÿéƒ¨ç½²æµç¨‹ï¼ŒåŒ…æ‹¬ç¯å¢ƒè¦æ±‚ã€éƒ¨ç½²æ­¥éª¤ã€è¿ç»´ç®¡ç†ã€æ•…éšœæ’é™¤å’Œå‡çº§ç®¡ç†ã€‚é€šè¿‡æŒ‰ç…§æœ¬æ–‡æ¡£æ‰§è¡Œéƒ¨ç½²ï¼Œå¯ä»¥ç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œæ»¡è¶³ç”Ÿäº§ç¯å¢ƒè¦æ±‚ã€‚

---

**æ–‡æ¡£ç»“æŸ**

**ç­¾å**: YYCÂ³ è¿ç»´å›¢é˜Ÿ  
**æ—¥æœŸ**: 2026-01-20
