# YYCÂ³ PortAISys æ„å»ºæµç¨‹æŒ‡å—

> ***YanYuCloudCube***
> è¨€å¯è±¡é™ | è¯­æ¢æœªæ¥
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> ä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒ
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|------|------|
| **æ–‡æ¡£åç§°** | YYCÂ³ PortAISys æ„å»ºæµç¨‹æŒ‡å— |
| **æ–‡æ¡£ç‰ˆæœ¬** | v1.0.0 |
| **åˆ›å»ºæ—¥æœŸ** | 2026-02-03 |
| **æœ€åæ›´æ–°** | 2026-02-03 |
| **æ–‡æ¡£çŠ¶æ€** | ğŸ“‹ æ­£å¼å‘å¸ƒ |
| **ä½œè€…** | YYCÂ³ Team |

---

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ YYCÂ³ PortAISys çš„æ„å»ºæµç¨‹ï¼ŒåŒ…æ‹¬å‰ç«¯æ„å»ºã€åç«¯æ„å»ºã€ç±»å‹æ£€æŸ¥å’Œä¼˜åŒ–ç­–ç•¥ã€‚

---

## ğŸ—ï¸ æ„å»ºæ¶æ„

### æ„å»ºæµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æºä»£ç       â”‚â”€â”€â”€â–¶â”‚  TypeScript  â”‚â”€â”€â”€â–¶â”‚   ç±»å‹æ£€æŸ¥    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ä»£ç æ£€æŸ¥    â”‚â”€â”€â”€â–¶â”‚   å•å…ƒæµ‹è¯•    â”‚â”€â”€â”€â–¶â”‚   æ„å»º        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   èµ„æºä¼˜åŒ–    â”‚â”€â”€â”€â–¶â”‚   ä»£ç åˆ†å‰²    â”‚â”€â”€â”€â–¶â”‚   è¾“å‡º        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ æ„å»ºè„šæœ¬

### NPM Scripts

```json
{
  "scripts": {
    "build": "tsc && vite build",
    "build:watch": "vite build --watch",
    "build:analyze": "vite build --mode analyze",
    "build:profile": "vite build --profile",
    "typecheck": "tsc --noEmit",
    "lint": "eslint core --ext .ts,.tsx",
    "lint:fix": "eslint . --ext .ts,.tsx --fix",
    "clean": "rm -rf dist .next"
  }
}
```

---

## ğŸ”§ TypeScript æ„å»º

### TypeScript é…ç½®

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "types": ["node"],
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "allowJs": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "isolatedModules": true,
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "outDir": "./dist",
    "baseUrl": ".",
    "paths": {
      "@/*": ["./core/*"],
      "@tests/*": ["./tests/*"]
    }
  },
  "include": [
    "core/**/*",
    "tests/**/*",
    "scripts/**/*.ts"
  ],
  "exclude": [
    "node_modules",
    "dist",
    "**/*.test.ts",
    "**/*.spec.ts"
  ]
}
```

### ç±»å‹æ£€æŸ¥

```bash
# ç±»å‹æ£€æŸ¥
pnpm typecheck

# ç±»å‹æ£€æŸ¥ï¼ˆç›‘å¬æ¨¡å¼ï¼‰
tsc --noEmit --watch

# ç”Ÿæˆç±»å‹å£°æ˜
tsc --emitDeclarationOnly
```

---

## ğŸ¨ Vite æ„å»º

### Vite é…ç½®

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],

  // æ„å»ºé…ç½®
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false,
    minify: 'esbuild',

    // ä»£ç åˆ†å‰²
    rollupOptions: {
      output: {
        manualChunks: {
          'react-vendor': ['react', 'react-dom'],
          'ui-vendor': ['@radix-ui/react-dialog', '@radix-ui/react-dropdown-menu'],
        },
      },
    },

    // å‹ç¼©é…ç½®
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true,
      },
    },

    // å—å¤§å°è­¦å‘Šé™åˆ¶
    chunkSizeWarningLimit: 1000,
  },

  // è§£æé…ç½®
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './core'),
      '@tests': path.resolve(__dirname, './tests'),
    },
  },

  // å¼€å‘æœåŠ¡å™¨
  server: {
    port: 3200,
    host: true,
    strictPort: true,
  },

  // é¢„è§ˆæœåŠ¡å™¨
  preview: {
    port: 4173,
    host: true,
  },
});
```

---

## ğŸš€ Next.js æ„å»º

### Dashboard æ„å»º

```bash
# è¿›å…¥ Dashboard ç›®å½•
cd web-dashboard

# å¼€å‘æ„å»º
pnpm build

# ç”Ÿäº§æ„å»º
NODE_ENV=production pnpm build

# åˆ†ææ„å»º
ANALYZE=true pnpm build
```

### Next.js é…ç½®ä¼˜åŒ–

```typescript
// web-dashboard/next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  // è¾“å‡ºæ¨¡å¼
  output: 'standalone',

  // ç¼–è¯‘ä¼˜åŒ–
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },

  // å‹ç¼©
  compress: true,

  // ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–
  productionBrowserSourceMaps: false,

  // å›¾ç‰‡ä¼˜åŒ–
  images: {
    formats: ['image/avif', 'image/webp'],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
  },

  // å®éªŒæ€§åŠŸèƒ½
  experimental: {
    optimizeCss: true,
    scrollRestoration: true,
  },
};

export default nextConfig;
```

---

## ğŸ§ª æ„å»ºå‰æ£€æŸ¥

### é¢„æ£€æŸ¥è„šæœ¬

```bash
#!/bin/bash
# scripts/pre-build.sh

echo "ğŸ” æ„å»ºå‰æ£€æŸ¥..."

# 1. ç±»å‹æ£€æŸ¥
echo "ğŸ“ ç±»å‹æ£€æŸ¥..."
pnpm typecheck
if [ $? -ne 0 ]; then
    echo "âŒ ç±»å‹æ£€æŸ¥å¤±è´¥"
    exit 1
fi

# 2. ä»£ç æ£€æŸ¥
echo "ğŸ” ESLintæ£€æŸ¥..."
pnpm lint
if [ $? -ne 0 ]; then
    echo "âŒ ESLintæ£€æŸ¥å¤±è´¥"
    exit 1
fi

# 3. å•å…ƒæµ‹è¯•
echo "ğŸ§ª è¿è¡Œå•å…ƒæµ‹è¯•..."
pnpm test:run
if [ $? -ne 0 ]; then
    echo "âŒ å•å…ƒæµ‹è¯•å¤±è´¥"
    exit 1
fi

echo "âœ… æ„å»ºå‰æ£€æŸ¥å®Œæˆï¼"
```

---

## ğŸ“Š æ„å»ºåˆ†æ

### Bundle åˆ†æ

```bash
# å®‰è£…åˆ†æå·¥å…·
pnpm add -D rollup-plugin-visualizer

# é…ç½® Vite
// vite.config.ts
import { visualizer } from 'rollup-plugin-visualizer';

export default defineConfig({
  plugins: [
    react(),
    visualizer({
      filename: './dist/stats.html',
      open: true,
      gzipSize: true,
      brotliSize: true,
    }),
  ],
});
```

### æ„å»ºç»Ÿè®¡

```typescript
// scripts/build-stats.ts
import fs from 'fs';
import path from 'path';

interface BuildStats {
  totalSize: number;
  totalFiles: number;
  largestFiles: Array<{ file: string; size: number }>;
}

function getBuildStats(outDir: string): BuildStats {
  let totalSize = 0;
  let totalFiles = 0;
  const files: Array<{ file: string; size: number }> = [];

  function walkDir(dir: string) {
    const entries = fs.readdirSync(dir, { withFileTypes: true });

    for (const entry of entries) {
      const fullPath = path.join(dir, entry.name);

      if (entry.isDirectory()) {
        walkDir(fullPath);
      } else {
        const stats = fs.statSync(fullPath);
        const size = stats.size;
        totalSize += size;
        totalFiles++;
        files.push({ file: fullPath, size });
      }
    }
  }

  walkDir(outDir);

  files.sort((a, b) => b.size - a.size);

  return {
    totalSize,
    totalFiles,
    largestFiles: files.slice(0, 10),
  };
}

const stats = getBuildStats('./dist');
console.log('ğŸ“Š æ„å»ºç»Ÿè®¡:');
console.log(`æ€»å¤§å°: ${(stats.totalSize / 1024 / 1024).toFixed(2)} MB`);
console.log(`æ€»æ–‡ä»¶æ•°: ${stats.totalFiles}`);
console.log('æœ€å¤§æ–‡ä»¶:');
stats.largestFiles.forEach(({ file, size }) => {
  console.log(`  ${file}: ${(size / 1024).toFixed(2)} KB`);
});
```

---

## âš¡ æ„å»ºä¼˜åŒ–

### ä¼˜åŒ–ç­–ç•¥

#### 1. Tree Shaking

```typescript
// ç¡®ä¿ä½¿ç”¨ ES Modules
import { useState } from 'react';  // âœ… æ­£ç¡®
// const React = require('react');  // âŒ é”™è¯¯

// å¯¼å…¥ç‰¹å®šå‡½æ•°
import { debounce } from 'lodash-es';  // âœ… æ­£ç¡®
// import _ from 'lodash';            // âŒ é”™è¯¯
```

#### 2. ä»£ç åˆ†å‰²

```typescript
// åŠ¨æ€å¯¼å…¥
const HeavyComponent = lazy(() => import('./HeavyComponent'));

// è·¯ç”±çº§åˆ«åˆ†å‰²
const Dashboard = lazy(() => import('./pages/Dashboard'));
const Settings = lazy(() => import('./pages/Settings'));
```

#### 3. å‹ç¼©ä¼˜åŒ–

```typescript
// vite.config.ts
export default defineConfig({
  build: {
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true,
        pure_funcs: ['console.log'],
      },
      format: {
        comments: false,
      },
    },
  },
});
```

---

## ğŸ”„ å¢é‡æ„å»º

### ç¼“å­˜é…ç½®

```typescript
// vite.config.ts
export default defineConfig({
  // æ–‡ä»¶ç³»ç»Ÿç¼“å­˜
  cacheDir: '.vite_cache',

  // æ„å»ºç¼“å­˜
  build: {
    // å¯ç”¨æºæ–‡ä»¶ç¼“å­˜
    cache: true,
  },
});
```

---

## ğŸš¨ æ„å»ºæ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### é—®é¢˜ 1: å†…å­˜æº¢å‡º

**ç—‡çŠ¶**: `JavaScript heap out of memory`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å¢åŠ  Node.js å†…å­˜é™åˆ¶
NODE_OPTIONS="--max-old-space-size=4096" pnpm build
```

#### é—®é¢˜ 2: ç±»å‹é”™è¯¯

**ç—‡çŠ¶**: TypeScript ç¼–è¯‘é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# æ¸…ç†ç¼“å­˜åé‡æ–°æ„å»º
rm -rf .next dist node_modules/.vite
pnpm install
pnpm build
```

#### é—®é¢˜ 3: å¾ªç¯ä¾èµ–

**ç—‡çŠ¶**: æ„å»ºè­¦å‘Šæˆ–é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨å¾ªç¯ä¾èµ–æ£€æŸ¥å·¥å…·
pnpm add -D madge

# æ£€æŸ¥å¾ªç¯ä¾èµ–
npx madge --circular --extensions ts,tsx core/
```

---

## âœ… æ„å»ºéªŒè¯

### éªŒè¯è„šæœ¬

```bash
#!/bin/bash
# scripts/verify-build.sh

echo "ğŸ” éªŒè¯æ„å»º..."

# 1. æ£€æŸ¥è¾“å‡ºç›®å½•
if [ ! -d "dist" ]; then
    echo "âŒ æ„å»ºè¾“å‡ºç›®å½•ä¸å­˜åœ¨"
    exit 1
fi

# 2. æ£€æŸ¥å…³é”®æ–‡ä»¶
REQUIRED_FILES=(
    "dist/index.html"
    "dist/assets/index.js"
    "dist/assets/index.css"
)

for file in "${REQUIRED_FILES[@]}"; do
    if [ ! -f "$file" ]; then
        echo "âŒ ç¼ºå°‘å…³é”®æ–‡ä»¶: $file"
        exit 1
    fi
done

# 3. æ£€æŸ¥æ–‡ä»¶å¤§å°
MAX_SIZE=$((100 * 1024 * 1024))  # 100MB
BUILD_SIZE=$(du -sb dist | cut -f1)

if [ $BUILD_SIZE -gt $MAX_SIZE ]; then
    echo "âš ï¸  è­¦å‘Š: æ„å»ºå¤§å°è¶…è¿‡é™åˆ¶: $(($BUILD_SIZE / 1024 / 1024))MB"
fi

echo "âœ… æ„å»ºéªŒè¯å®Œæˆï¼"
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [05-Dockerå®¹å™¨åŒ–](./05-Dockerå®¹å™¨åŒ–.md)
- [10-CI-CDæµæ°´çº¿](./10-CI-CDæµæ°´çº¿.md)

---

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ä¸»é¡µ**: https://github.com/YYC-Cube/YYC3-PortAISys
- **é—®é¢˜åé¦ˆ**: https://github.com/YYC-Cube/YYC3-PortAISys/issues
- **é‚®ç®±**: admin@0379.email

---

> **ã€Œä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒã€**
> **All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence**

Made with â¤ï¸ by YYCÂ³ Team
